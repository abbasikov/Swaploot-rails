<div class="p-6">
 <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
 <div style= "display: flex;">
    <h2 class="text-2xl font-bold mb-4">Inventory</h2>
    <i id="refreshTable" class="fa fa-refresh" aria-hidden="true"></i>
    </div>

<table id="dataTable" class="display" style="width:100%">
 <thead>
            <tr>
                <th class="px-4 py-2">Item ID</th>
                <th class="px-4 py-2">Market Name</th>
                <th class="px-4 py-2">Market Price</th>
                <th class="px-4 py-2">Tradable</th>
            </tr>
        </thead>
        <tbody>
        <% @inventories.each do |inventory| %>
            <tr>
                <td class="border text-center px-4 py-2"><%= inventory.item_id %></td>
                <td class="border text-center px-4 py-2"><%= inventory.market_name %></td>
                <td class="border text-center px-4 py-2"><%= "$#{inventory.market_price}" %></td>
                <td class="border text-center px-4 py-2"><%= inventory.tradable %></td>
            </tr>
        <% end %>
        </tbody>
    </table>
</div>
</div>



<script>
    $(document).ready(function() {
        var dataTable = $('#dataTable').DataTable({
            "order": [[2, 'desc']], // Assuming market_price is the third column (zero-based index)
        });

        const searchInputs = document.querySelectorAll('input[type="search"]');
        searchInputs.forEach(function(input) {
            input.style.marginBottom = '10px';
        });

        const dataTables = document.querySelectorAll('.dataTable');
        dataTables.forEach((el) => {
            el.style.border = '1px solid black';
        });

        var elements = document.querySelectorAll('.dataTables_length');
        for (var i = 0; i < elements.length; i++) {
            elements[i].parentNode.removeChild(elements[i]);
        }

      $('#refreshTable').click(function() {
            $.ajax({
                url: '<%= inventories_path(format: :json) %>',
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    dataTable.clear().draw();

                    data.forEach(function(inventory) {
                        dataTable.row.add([
                            inventory.item_id,
                            inventory.market_name,
                            "$" + inventory.market_price,
                            inventory.tradable
                        ]).draw();
                    });

                    console.log('Table refreshed');
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('Error refreshing table', textStatus, errorThrown);
                }
            });
        });
    });
</script>